<shad:Window xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:FlowGraph.Demo.ViewModels"
             xmlns:lucide="clr-namespace:LucideAvalonia;assembly=LucideAvalonia"
             xmlns:shad="clr-namespace:ShadUI;assembly=ShadUI"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="FlowGraph.Demo.Views.MainWindow"
             x:DataType="vm:MainWindowViewModel"
             x:Name="Window"
             Icon="/Assets/avalonia-logo.ico"
             Title="FlowGraph Demo"
             Width="1200" Height="800"
             SaveWindowState="True"
             WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <!-- Window Logo -->
    <shad:Window.LogoContent>
        <Border Background="{DynamicResource PrimaryBrush}"
                CornerRadius="4"
                Width="18" Height="18"
                Margin="8,0,0,0">
            <lucide:Lucide Icon="Workflow"
                           StrokeThickness="2"
                           Width="12" Height="12"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center" />
        </Border>
    </shad:Window.LogoContent>

    <!-- Title Bar Right Content -->
    <shad:Window.RightWindowTitleBarContent>
        <StackPanel Orientation="Horizontal" Spacing="4">
            <!-- Theme Toggle -->
            <Button Background="Transparent"
                    BorderThickness="0"
                    CornerRadius="6"
                    Width="32" Height="32"
                    Padding="0"
                    Command="{Binding SwitchThemeCommand}"
                    ToolTip.Tip="Toggle Theme">
                <Panel>
                    <lucide:Lucide Icon="Sun"
                                   StrokeThickness="1.5"
                                   Width="16" Height="16"
                                   IsVisible="{Binding IsDarkTheme}" />
                    <lucide:Lucide Icon="Moon"
                                   StrokeThickness="1.5"
                                   Width="16" Height="16"
                                   IsVisible="{Binding !IsDarkTheme}" />
                </Panel>
            </Button>
        </StackPanel>
    </shad:Window.RightWindowTitleBarContent>

    <Panel>
        <Grid ColumnDefinitions="Auto,*">
            <!-- Sidebar -->
            <shad:Sidebar x:Name="MainSidebar"
                          Grid.Column="0"
                          Expanded="{Binding #SidebarToggle.IsChecked}"
                          CurrentRoute="{Binding CurrentRoute}"
                          MinWidth="56"
                          BorderBrush="{DynamicResource BorderBrush}"
                          BorderThickness="0,0,1,0">

                <!-- Header with Toggle -->
                <shad:Sidebar.Header>
                    <ToggleButton x:Name="SidebarToggle"
                                  CornerRadius="8"
                                  Height="36"
                                  Width="36"
                                  IsChecked="True"
                                  Padding="0"
                                  Margin="10,8"
                                  Theme="{DynamicResource SideTogglerTheme}"
                                  ToolTip.Tip="Toggle Sidebar">
                        <Viewbox Width="18" Height="18">
                            <lucide:Lucide Icon="PanelLeft" StrokeThickness="1.5" />
                        </Viewbox>
                    </ToggleButton>
                </shad:Sidebar.Header>

                <!-- Navigation Items -->
                <StackPanel Spacing="4">
                    <shad:SidebarItemLabel AsSeparator="True" 
                                           IsVisible="{Binding #MainSidebar.Expanded}" />

                    <shad:SidebarItem Command="{Binding OpenInteractiveCommand}"
                                      Content="Interactive 3D"
                                      Route="interactive"
                                      IsChecked="True">
                        <shad:SidebarItem.Icon>
                            <Viewbox>
                                <lucide:Lucide Icon="Boxes" StrokeThickness="1.5" />
                            </Viewbox>
                        </shad:SidebarItem.Icon>
                    </shad:SidebarItem>

                    <shad:SidebarItem Command="{Binding OpenEdgeStylesCommand}"
                                      Content="Edge Styles"
                                      Route="edge-styles">
                        <shad:SidebarItem.Icon>
                            <Viewbox>
                                <lucide:Lucide Icon="Sparkles" StrokeThickness="1.5" />
                            </Viewbox>
                        </shad:SidebarItem.Icon>
                    </shad:SidebarItem>

                    <shad:SidebarItem Command="{Binding OpenShapesCommand}"
                                      Content="Shapes &amp; Layers"
                                      Route="shapes">
                        <shad:SidebarItem.Icon>
                            <Viewbox>
                                <lucide:Lucide Icon="Layers" StrokeThickness="1.5" />
                            </Viewbox>
                        </shad:SidebarItem.Icon>
                    </shad:SidebarItem>

                    <shad:SidebarItem Command="{Binding OpenPerformanceCommand}"
                                      Content="Performance"
                                      Route="performance">
                        <shad:SidebarItem.Icon>
                            <Viewbox>
                                <lucide:Lucide Icon="Gauge" StrokeThickness="1.5" />
                            </Viewbox>
                        </shad:SidebarItem.Icon>
                    </shad:SidebarItem>
                </StackPanel>

                <!-- Footer -->
                <shad:Sidebar.Footer>
                    <Grid Margin="4,8">
                        <!-- Version when expanded -->
                        <StackPanel Orientation="Horizontal"
                                    HorizontalAlignment="Center"
                                    Spacing="6"
                                    Opacity="0.6"
                                    IsVisible="{Binding #MainSidebar.Expanded}">
                            <lucide:Lucide Icon="Tag"
                                           StrokeThickness="1.5"
                                           Width="12" Height="12" />
                            <TextBlock Text="v0.5.0"
                                       FontSize="11"
                                       VerticalAlignment="Center" />
                        </StackPanel>
                        
                        <!-- Icon when collapsed -->
                        <lucide:Lucide Icon="Tag"
                                       StrokeThickness="1.5"
                                       Width="14" Height="14"
                                       Opacity="0.5"
                                       HorizontalAlignment="Center"
                                       IsVisible="{Binding !#MainSidebar.Expanded}"
                                       ToolTip.Tip="v0.5.0" />
                    </Grid>
                </shad:Sidebar.Footer>
            </shad:Sidebar>

            <!-- Main Content -->
            <TransitioningContentControl Grid.Column="1"
                                         Content="{Binding SelectedPage}"
                                         Background="{DynamicResource BackgroundBrush}" />
        </Grid>
    </Panel>
</shad:Window>

